import{h as e,withDirectives as n,vShow as t,resolveDirective as o,defineComponent as a,ref as l,computed as r,openBlock as d,createElementBlock as s,toDisplayString as c,createCommentVNode as u,createElementVNode as i,normalizeClass as p,onBeforeMount as f,onMounted as m,onUnmounted as v,watch as g,warn as y,normalizeStyle as h,renderSlot as b,resolveComponent as x,createBlock as N,Teleport as D,createVNode as C,withCtx as E,nextTick as S,reactive as k,Transition as z,Fragment as O,renderList as M,vModelText as R}from"vue";var _="vue3-tree-org",w="3.0.0";const $=function(e){return"[object Object]"===Object.prototype.toString.call(e)},B=function(e){return"string"==typeof e},A=function(e){return"number"==typeof e},F={print:(e,n,t)=>B(n)||"boolean"==typeof t,pretty:(e,n,t)=>B(n)&&B(e)||"string"==typeof t,primary:(e,n)=>B(e)||"boolean"==typeof n,success:(e,n)=>B(e)||"boolean"==typeof n,info:(e,n)=>B(e)||"boolean"==typeof n,warning:(e,n)=>B(e)||"boolean"==typeof n,danger:(e,n)=>B(e)||"boolean"==typeof n};function T(e="default"){let n="";switch(e){case"primary":n="#2d8cf0";break;case"success":n="#19be6b";break;case"info":n="#909399";break;case"warning":n="#ff9900";break;case"danger":n="#ff4d4f";break;case"default":n="#35495E";break;default:n=e}return n}F.print=function(e,n="default",t=!1){return"object"==typeof e?(console.dir(e),!0):(t?console.log(`%c ${e} `,`background:${T(n)}; padding: 2px; border-radius: 4px;color: #fff;`):console.log(`%c ${e} `,`color: ${T(n)};`),!0)},F.pretty=function(e,n,t="primary"){return console.log(`%c ${e} %c ${n} %c`,`background:${T(t)};border:1px solid ${T(t)}; padding: 1px; border-radius: 4px 0 0 4px; color: #fff;`,`border:1px solid ${T(t)}; padding: 1px; border-radius: 0 4px 4px 0; color: ${T(t)};`,"background:transparent"),!0},F.primary=function(e,n=!1){return this.print&&this.print(e,"primary",n),!0},F.success=function(e,n=!1){return this.print&&this.print(e,"success",n),!0},F.info=function(e,n=!1){return this.print&&this.print(e,"info",n),!0},F.warning=function(e,n=!1){return this.print&&this.print(e,"warning",n),!0},F.danger=function(e,n=!1){return this.print&&this.print(e,"danger",n),!0};var L={async install(e){e.config.globalProperties.$log=F,F.pretty("["+_+"] "+w,"success")}};const j=function(e,n,t){const{id:o,children:a}=n;if(e[o]===t)return e;if(Array.isArray(e[a])){const o=e[a];for(let e=0,a=o.length;e<a;e++){const a=o[e],l=j(a,n,t);if(l)return l}}},V=function(e,n){const{parenNode:t,onlyOneNode:o,cloneNodeDrag:a}=n;if(t.value){const{keys:l}=n,{id:r,pid:d}=l,s=t.value,c=JSON.parse(JSON.stringify(e));if(c.root&&(c.root=void 0),a){!function(e,n,t){const{children:o}=n;if($(e))a(e);else if(Array.isArray(e))for(let n=0,t=e.length;n<t;n++)a(e[n]);function a(e){if(t(e),Array.isArray(e[o])){const n=e[o];for(let e=0,t=n.length;e<t;e++)a(n[e])}}}(c,l,(function(e){"string"==typeof e[r]&&-1!==e[r].indexOf("clone-node")&&(e[r]=`clone-node-${e[r]}`)}));const{children:e}=l;o&&Array.isArray(c[e])&&(c[e]=[]),c[l.pid]=s[l.id],s.children?s.children.push(c):s.children=[c]}else!function(e,n){const{keys:t,data:o,onlyOneNode:a}=n,{id:l,pid:r,children:d}=t,s=j(o,t,e[r]),c=s[d];let u;for(let n=0,t=c.length;n<t;n++)if(c[n][l]===e[l]){c.splice(n,1),u=n;break}const i=e[d];a&&void 0!==u&&i&&(e[d]=[],i.forEach((e=>{e[r]=s[l]})),s[d].splice(u,0,...i))}(c,n),c[d]=s[r],s.children?s.children.push(c):s.children=[].concat(c)}},Y={beforeMount(e,n){const{l:t,t:o}=n.modifiers,{drag:a,dragData:l,node:r,handleStart:d,handleMove:s,handleEnd:c}=n.value,{value:u}=n,i={...l};e.addEventListener("mousedown",(function(e){e.stopPropagation();const n=e.target;if(!1===a||0!==e.button||r.focused||r.noDragging||n.className.indexOf("tree-org-node-btn")>-1)return!1;(function(e){v=e.screenX,g=e.screenY,f=0,i.contextmenu.value=!1;const{keys:n,onlyOneNode:t}=i;if(t){const{children:e}=n,t={...r};t[e]=[],i.cloneData.data=t}else i.cloneData.data=r})(e),document.addEventListener("mousemove",y),document.addEventListener("mouseup",h),b("start")}));let p,f=0,m=!1,v=0,g=0;function y(n){return n.preventDefault(),!(Math.abs(n.screenX-v)<5&&Math.abs(n.screenY-g)<5)&&(m||(m=!0,function(n){i.nodeMoving.value=!0,r.moving=!0;let t=e;for(;!t.classList.contains("tree-org-node");)f+=t.offsetLeft,t=t.offsetParent;f+=2,p=document.querySelector("#clone-tree-org"),p&&(p.style.width=`${t.clientWidth}px`,p.style.opacity="0.8",p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px")}(n)),t&&o&&u?(p&&(p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px"),void b("move")):t&&u?(e.style.left=n.clientX-f+"px",void b("move")):void(o&&u&&(e.style.top=n.clientY+"px",b("move"))))}function h(e){if(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",h),!m)return;m=!1,p=null,r.moving=!1,i.nodeMoving.value=!1;const n=document.querySelector(".tree-org-node__moving");if(n&&n.contains(e.target))return b("end",!0),!1;V(r,i),b("end",!1)}function b(e,n){"start"!==e?"move"!==e?"end"===e&&"function"==typeof c&&c(r,n):"function"==typeof s&&s(r):"function"==typeof d&&d(r)}}};const X={onClick:"onNodeClick",onDblclick:"onNodeDbclick",onContextmenu:"onNodeContextmenu",onMouseenter:"onNodeMouseenter",onMouseleave:"onNodeMouseleave"};function P(e,n){if("function"==typeof e)return function(t){t.target.className.indexOf("org-tree-node-btn")>-1||e(t,n)}}const q=(e,n)=>!(Array.isArray(e[n])&&e[n].length>0),U=(e,o,a,l)=>{const{attrs:r}=a,d=["tree-org-node"],s=[],c=r.props,u=o[c.children];void 0===o[c.expand]&&o.$$level<r.defaultExpandLevel&&(o[c.expand]=!0);const i=o[c.expand];return q(o,c.children)?d.push("is-leaf"):r.collapsable&&!i&&d.push("collapsed"),o.moving&&d.push("tree-org-node__moving"),s.push(W(e,o,a,l)),r.collapsable&&!i||s.push(K(e,u,a,o.$$level)),n(e("div",{class:d,key:o[c.id]},s),[[t,!o.hidden]])},W=(e,a,l,r)=>{const{attrs:d}=l,s=d.props,c=a[s.label],u=d.renderContent,i=[];if(l.slots.default)i.push(l.slots.default({node:a}));else if("function"==typeof u){F.warning("scoped-slot header is easier to use. We recommend users to use scoped-slot header.");const n=u(e,a);n&&i.push(n)}else i.push(c);d.collapsable&&!q(a,s.children)&&i.push(((e,n,t)=>{const{attrs:o}=t,a=o.onOnExpand,l=["tree-org-node__expand"],r=o.props;n[r.expand]&&l.push("expanded");const d=[];return t.slots.expand?d.push(t.slots.expand({node:n})):d.push(e("span",{class:"tree-org-node__expand-btn"})),e("span",{class:l,onClick:e=>{e.stopPropagation(),a&&a(e,n)}},d)})(e,a,l));const p=["tree-org-node__inner"];let{labelStyle:f,labelClassName:m,selectedClassName:v,selectedKey:g}=d;"function"==typeof m&&(m=m(a)),m&&p.push(m),a.className&&p.push(a.className),"function"==typeof v&&(v=v(a)),void 0!==g&&(g=Array.isArray(g)?g:[g]),v&&g&&g.includes(a[s.id])&&p.push(v);const y=["tree-org-node__content"];r&&y.push("is-root"),a[s.label]||y.push("is-empty"),a.focused&&y.push("is-edit");const h=o("nodedrag"),b=[];d.vNodedrag&&h&&!r&&b.push([h,Object.assign({node:a},d.vNodedrag),"",{l:!0,t:!0}]);const x={};for(const e in X)if(Object.prototype.hasOwnProperty.call(X,e)){const n=d[X[e]];n&&(x[e]=P(n,a))}const N=d.onNodeFocus,D=d.onNodeBlur,C=o("focus"),E=[[t,a.focused]];return C&&E.push([C,a.focused]),e("div",{class:y},[n(e("div",{class:p,style:a.style?a.style:f,...x},i),b),n(e("textarea",{class:"tree-org-node__textarea",placeholder:"请输入节点名称",value:a[s.label],onFocus:e=>N&&N(e,a),onInput:e=>{a[s.label]=e.target.value},onBlur:e=>{a.focused=!1,D&&D(e,a)},onClick:e=>e.stopPropagation()}),E)])},K=(e,n,t,o)=>{if(Array.isArray(n)&&n.length){const a=n.map((n=>(n.$$level=o+1,U(e,n,t,!1))));return e("div",{class:"tree-org-node__children"},a)}return""},I=(n,t)=>n.data?(n.data.root=!n.isClone,n.data.$$level=0,U(e,n.data,t,!0)):"";I.directives={focus:{mounted(e,{value:n}){n&&e.focus()},updated(e,{value:n}){n&&e.focus()}},nodedrag:Y};var J=a({props:{scale:String,tools:Object},setup(e,{emit:n}){const t=l(!1),o=l(!1);const a=r((()=>t.value?"全部收起":"全部展开")),d=r((()=>o.value?"退出全屏":"全屏"));return{expanded:t,fullscreen:o,expandTitle:a,fullTiltle:d,handleExpand:function(){t.value=!t.value,n("onExpand")},handleScale:function(e){"out"===e?n("onScale",.1):"in"===e?n("onScale",-.1):n("onRestore")},handleFullscreen:function(){o.value=!o.value,n("onFullscreen")}}}});const H={class:"zm-tree-handle"},G={key:0,class:"zm-tree-percent"},Q=["title"],Z={class:"zm-tree-svg"},ee=[i("span",{class:"zm-tree-icon"},"+",-1)],ne=[i("span",{class:"zm-tree-icon"},"-",-1)],te=[i("span",{class:"zm-tree-restore"},null,-1)],oe=["title"],ae={class:"zm-tree-svg"};function le(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)}function re(e,n,t,o=1){return{deltaX:Math.round(n/o/e[0])*e[0],deltaY:Math.round(t/o/e[1])*e[1]}}function de(e,n,t){return e<n?n:t<e?t:e}J.render=function(e,n,t,o,a,l){return d(),s("div",H,[e.tools.scale?(d(),s("div",G,c(e.scale),1)):u("v-if",!0),e.tools.expand?(d(),s("div",{key:1,onClick:n[0]||(n[0]=(...n)=>e.handleExpand&&e.handleExpand(...n)),title:e.expandTitle,class:"zm-tree-handle-item"},[i("span",Z,[i("i",{class:p(["iconfont",e.expanded?"icon-collapse":"icon-expand"])},null,2)])],8,Q)):u("v-if",!0),e.tools.zoom?(d(),s("div",{key:2,onClick:n[1]||(n[1]=n=>e.handleScale("out")),title:"放大",class:"zm-tree-handle-item zoom-out"},ee)):u("v-if",!0),e.tools.zoom?(d(),s("div",{key:3,onClick:n[2]||(n[2]=n=>e.handleScale("in")),title:"缩小",class:"zm-tree-handle-item zoom-in"},ne)):u("v-if",!0),e.tools.restore?(d(),s("div",{key:4,onClick:n[3]||(n[3]=n=>e.handleScale("restore")),title:"还原",class:"zm-tree-handle-item"},te)):u("v-if",!0),e.tools.fullscreen?(d(),s("div",{key:5,onClick:n[4]||(n[4]=(...n)=>e.handleFullscreen&&e.handleFullscreen(...n)),title:e.fullTiltle,class:"zm-tree-handle-item"},[i("span",ae,[i("i",{class:p(["iconfont",e.fullscreen?"icon-unfullscreen":"icon-fullscreen"])},null,2)])],8,oe)):u("v-if",!0)])},J.__file="src/components/tools/tools.vue";const se=function(e,n,t,o=!1){e&&n&&t&&e.addEventListener(n,t,o)},ce=function(e,n,t,o=!1){e&&n&&t&&e.removeEventListener(n,t,o)},ue=(e,{emit:n},t)=>{const o={start:"mousedown",move:"mousemove",stop:"mouseup"},a={start:"touchstart",move:"touchmove",stop:"touchend"},d={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},s={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let c=o;const u=l(e.x),i=l(e.y),p=l(e.z),y=l(e.active),h=l(!1),b=l(0),x=l(0),N=l(0),D=l(0),C=l(0),E=l(0);let S={},k={};function z(){S={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},k={minLeft:-1/0,maxLeft:1/0,minRight:-1/0,maxRight:1/0,minTop:-1/0,maxTop:1/0,minBottom:-1/0,maxBottom:1/0}}function O(){if(e.parent){const[e,n]=M();C.value=e||0,E.value=n||0}}function M(){if(e.parent&&t.eleRef.value){const e=window.getComputedStyle(t.eleRef.value.parentNode,null);return[parseInt(e.getPropertyValue("width"),10),parseInt(e.getPropertyValue("height"),10)]}return[0,0]}function R(o){if(o instanceof MouseEvent&&1!==o.which)return;const a=o.target||o.srcElement;if(a&&t.eleRef.value&&t.eleRef.value.contains(a)){if(e.dragCancel&&function(e,n,t){let o=e;const a=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find((e=>o&&le(o[e])))||"";if(!le(o[a]))return!1;do{if(o[a](n))return!0;if(o===t)return!1;o=o.parentNode}while(o);return!1}(a,e.dragCancel,t.eleRef.value))return void(h.value=!1);y.value||(y.value=!0,n("activated"),n("update:active",!0)),e.draggable&&(h.value=!0),o instanceof MouseEvent?(S.mouseX=o.pageX,S.mouseY=o.pageY):(S.mouseX=o.touches[0].pageX,S.mouseY=o.touches[0].pageY),S.left=u.value,S.right=b.value,S.top=i.value,S.bottom=x.value,e.parent&&(k=_()),se(document.documentElement,c.move,$),se(document.documentElement,c.stop,B)}}function _(){const n=e.grid;return{minLeft:u.value%n[0],maxLeft:Math.floor((C.value-N.value-u.value)/n[0])*n[0]+u.value,minRight:b.value%n[0],maxRight:Math.floor((C.value-N.value-b.value)/n[0])*n[0]+b.value,minTop:i.value%n[1],maxTop:Math.floor((E.value-D.value-i.value)/n[1])*n[1]+i.value,minBottom:x.value%n[1],maxBottom:Math.floor((E.value-D.value-x.value)/n[1])*n[1]+x.value}}function w(o){const a=o.target||o.srcElement;t.eleRef.value&&!t.eleRef.value.contains(a)&&y.value&&!e.preventDeactivation&&(y.value=!1,n("deactivated"),n("update:active",!1))}function $(t){h.value&&function(t){const o=e.axis,a=e.grid;let l=0,r=0;t instanceof MouseEvent?(l=t.pageX,r=t.pageY):(l=t.touches[0].pageX,r=t.touches[0].pageY);const d=o&&"y"!==o?S.mouseX-l:0,s=o&&"x"!==o?S.mouseY-r:0,{deltaX:c,deltaY:p}=re(a,d,s,e.scale),f=de(S.left-c,k.minLeft,k.maxLeft),m=de(S.top-p,k.minTop,k.maxTop),v=de(S.right+c,k.minRight,k.maxRight),g=de(S.bottom+p,k.minBottom,k.maxBottom);u.value=f,i.value=m,b.value=v,x.value=g,n("dragging",u.value,i.value)}(t)}function B(){z(),h.value&&(h.value=!1,n("dragstop",u.value,i.value))}f((()=>{z()})),m((()=>{!e.enableNativeDrag&&t.eleRef.value&&(t.eleRef.value.ondragstart=()=>!1);const[n,o]=M();if(C.value=n,E.value=o,t.eleRef.value){const[e,n]=function(e){const n=window.getComputedStyle(e);return[parseFloat(n.getPropertyValue("width")),parseFloat(n.getPropertyValue("height"))]}(t.eleRef.value);N.value=e,D.value=n,b.value=C.value-N.value-u.value,x.value=E.value-D.value-i.value}se(document.documentElement,"mousedown",w),se(document.documentElement,"touchend touchcancel",w),se(window,"resize",O)})),v((()=>{ce(document.documentElement,"mousedown",w),ce(document.documentElement,"touchstart",B),ce(document.documentElement,"mousemove",$),ce(document.documentElement,"touchmove",$),ce(document.documentElement,"mouseup",B),ce(document.documentElement,"touchend touchcancel",w),ce(window,"resize",O)}));const A=r((()=>({transform:`translate(${u.value}px, ${i.value}px)`,zIndex:p.value,...h.value&&e.disableUserSelect?d:s})));return g((()=>e.active),(e=>{y.value=e,n(e?"activated":"deactivated")})),g((()=>e.z),(e=>{(e>=0||"auto"===e)&&(p.value=e)})),g((()=>e.x),(n=>{h.value||(e.parent&&(k=_()),function(n){const{deltaX:t}=re(e.grid,n,i.value,e.scale),o=de(t,k.minLeft,k.maxLeft);u.value=o,b.value=C.value-N.value-o}(n))})),g((()=>e.y),(n=>{h.value||(e.parent&&(k=_()),function(n){const{deltaY:t}=re(e.grid,u.value,n,e.scale),o=de(t,k.minTop,k.maxTop);i.value=o,x.value=E.value-D.value-o}(n))})),{enabled:y,dragging:h,style:A,resetBoundsAndMouseState:z,elementTouchDown:function(e){c=a,R(e)},elementMouseDown:function(e){c=o,R(e)}}};"production"===process.env.NODE_ENV||Object.freeze({}),"production"===process.env.NODE_ENV||Object.freeze([]);const ie=Symbol("wrapper");function pe(e,n){if(null===(t=e)||"object"!=typeof t||e.__elPropsReservedKey)return e;var t;const{values:o,required:a,default:l,type:r,validator:d}=e,s=o||d?e=>{let t=!1,a=[];if(o&&(a=[...o,l],t=t||a.includes(e)),d&&(t=t||d(e)),!t&&a.length>0){const t=[...new Set(a)].map((e=>JSON.stringify(e))).join(", ");y(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${t}], got value ${JSON.stringify(e)}.`)}return t}:void 0;return{type:"object"==typeof r&&Object.getOwnPropertySymbols(r).includes(ie)?r[ie]:r,validator:s,__elPropsReservedKey:!0,default:l,required:!!a}}const fe=e=>function(e){let n=-1;const t=e?e.length:0,o={};for(;++n<t;){const t=e[n];o[t[0]]=t[1]}return o}(Object.entries(e).map((([e,n])=>[e,pe(n,e)]))),me=e=>({[ie]:e});var ve=a({replace:!0,name:"Draggable",props:fe({className:{type:String,default:"zm-draggable"},classNameDraggable:{type:String,default:"draggable"},classNameDragging:{type:String,default:"dragging"},classNameActive:{type:String,default:"active"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:e=>"string"==typeof e?"auto"===e:e>=0},dragCancel:String,axis:{type:String,default:"both",validator:e=>["x","y","both"].includes(e)},grid:{type:Array,default:()=>[1,1]},parent:{type:Boolean,default:!1},scale:{type:Number,default:1,validator:e=>e>0}}),emits:{activated:()=>!0,deactivated:()=>!0,dragging:(e,n)=>A(e)&&A(n),dragstop:(e,n)=>A(e)&&A(n),"update:active":e=>"boolean"==typeof e},setup(e,n){const t=l(),o=ue(e,n,{eleRef:t});return{top:top,eleRef:t,...o}}});ve.render=function(e,n,t,o,a,l){return d(),s("div",{style:h(e.style),class:p([{[e.classNameActive]:e.enabled,[e.classNameDragging]:e.dragging,[e.classNameDraggable]:e.draggable},e.className]),ref:"eleRef",onMousedown:n[0]||(n[0]=(...n)=>e.elementMouseDown&&e.elementMouseDown(...n)),onTouchstart:n[1]||(n[1]=(...n)=>e.elementTouchDown&&e.elementTouchDown(...n))},[b(e.$slots,"default")],38)},ve.__file="src/components/draggable/src/draggable.vue";var ge=a({components:{TreeOrgNode:I},props:fe({data:{type:Object,required:!0},props:{type:me(Object)},modelValue:Boolean,horizontal:Boolean,selectedKey:String,collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]}})});const ye={id:"clone-tree-org",class:"clone-tree-org tree-org"};ge.render=function(e,o,a,l,r,s){const c=x("tree-org-node");return d(),N(D,{to:"body"},[n(i("div",ye,[C(c,{data:e.data,props:e.props,isClone:!1,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,labelClassName:e.labelClassName},{default:E((({node:n})=>[b(e.$slots,"default",{node:n})])),expand:E((({node:n})=>[b(e.$slots,"expand",{node:n})])),_:3},8,["data","props","horizontal","labelStyle","collapsable","renderContent","labelClassName"])],512),[[t,e.modelValue]])])},ge.__file="src/components/clone-org/clone-org.vue";const he=(e,{emit:n},t)=>{const o=l("");function a(e,n,t){if(e[n]===t)return e;if(Array.isArray(e.children)){const o=e.children;for(let e=0,l=o.length;e<l;e++){const l=a(o[e],n,t);if(l)return l}}}function d(){const{props:t,data:o,node:l}=e;if(e.nodeDelete)return void e.nodeDelete(l);if(l.root)return void F.pretty("[提示] ","根节点不允许删除","danger");const{id:r,pid:d,children:s}=t,c=a(o,r,l[d]);if(c){const e=c[s];for(let t=0,o=e.length;t<o;t++)if(e[t][r]===l[r]){e.splice(t,1),n("onNodeDelete",l);break}}}function s(){const{nodeEdit:n,node:t}=e;n?n(t):t.focused=!0}function c(o){if(e.modelValue){if(t.eleRef.value&&t.eleRef.value.contains(o.target))return!1;n("update:modelValue",!1)}}const u=r((()=>({left:`${e.x}px`,top:`${e.y}px`}))),i=r((()=>!e.disabled&&!e.node.disabled));return m((()=>{document.addEventListener("mousedown",c)})),v((()=>{document.removeEventListener("mousedown",c)})),{position:u,editable:i,handleMenu:function(a){const l=a.target;if("zm-tree-menu-item"===l.className){const a=l.getAttribute("action");switch(a){case"copy":!function(){if(e.nodeCopy)return void e.nodeCopy(e.node);o.value=e.node[e.props.label],S((()=>{t.inputRef&&t.inputRef.value&&(t.inputRef&&t.inputRef.value.select(),navigator.clipboard.writeText(o.value).then((function(){F.pretty("[提示] ","文本复制成功","success")}),(function(){F.pretty("[错误] ","浏览器不支持","danger")})),n("onNodeCopy",o.value))}))}();break;case"add":!function(){if(e.nodeAdd)return void e.nodeAdd(e.node);const{id:n,pid:t,label:o,expand:a,children:l}=e.props,{node:r}=e,d={[n]:String((new Date).getTime()),[t]:r[n],[o]:"",[a]:!1,[l]:[],newNode:!0,focused:!0};Array.isArray(r[l])?r[l].push(d):r[l]=[d]}();break;case"edit":s();break;case"delete":d()}n("contextmenu",{command:a,node:e.node}),n("update:modelValue",!1)}},handleEdit:s,handleClose:c,afterEnter:function(){n("opened")},afterLeave:function(){n("closed")}}};var be=a({name:"Contextmenu",props:fe({modelValue:{type:Boolean,required:!0},data:{type:Object,required:!0},node:{type:Object,required:!0},props:{type:me(Object)},x:Number,y:Number,menus:{type:me(Array)},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,disabled:Boolean}),emits:{onNodeDelete:e=>$(e),onNodeCopy:e=>B(e),contextmenu:e=>$(e),opened:()=>!0,closed:()=>!0,"update:modelValue":e=>"boolean"==typeof e},setup(e,n){const t=l(),o=l();return{eleRef:o,inputRef:t,copyText:l(""),oldData:k({}),...he(e,n,{inputRef:t,eleRef:o})}}});const xe=["action"];be.render=function(e,o,a,l,r,p){return d(),N(D,{to:"body"},[C(z,{name:"dialog-fade",onAfterEnter:e.afterEnter,onAfterLeave:e.afterLeave},{default:E((()=>[n(i("div",{style:h(e.position),onClick:o[1]||(o[1]=(...n)=>e.handleMenu&&e.handleMenu(...n)),ref:"eleRef",class:"zm-tree-contextmenu"},[i("ul",null,[(d(!0),s(O,null,M(e.menus,(n=>(d(),s(O,null,[e.editable||!["add","edit","delete"].includes(n.command)?(d(),s("li",{class:"zm-tree-menu-item",action:n.command,key:n.command},c(n.name),9,xe)):u("v-if",!0)],64)))),256))]),n(i("textarea",{class:"copy-textarea",ref:"inputRef","onUpdate:modelValue":o[0]||(o[0]=n=>e.copyText=n)},null,512),[[R,e.copyText]])],4),[[t,e.modelValue]])])),_:1},8,["onAfterEnter","onAfterLeave"])])},be.__file="src/components/contextmenu/src/contextmenu.vue";const Ne=[{name:"复制文本",command:"copy"},{name:"新增节点",command:"add"},{name:"编辑节点",command:"edit"},{name:"删除节点",command:"delete"}],De=fe({data:{type:Object,required:!0},props:{type:me(Object),default:()=>({id:"id",pid:"pid",label:"label",expand:"expand",children:"children"})},toolBar:{type:[Object,Boolean],default:()=>({expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0})},disabled:{type:Boolean,default:!1},scalable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},draggableOnNode:{type:Boolean,default:!1},nodeDraggable:{type:Boolean,default:!0},cloneNodeDrag:{type:Boolean,default:!0},onlyOneNode:{type:Boolean,default:!0},clickDelay:{type:Number,default:260},defaultExpandLevel:Number,nodeDragStart:Function,nodeDraging:Function,nodeDragEnd:Function,horizontal:Boolean,selectedKey:{type:[Array,String,Number]},collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]},selectedClassName:{type:[Function,String]},defineMenus:{type:me(Array),default:()=>Ne},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function}),Ce=(e,{emit:n},t)=>{const o=l(0),a=l(0),d=l(!1);function s(e,n){const l=t.zoomRef.value,r=t.treeRef.value,d=l.clientWidth/2,s=l.clientHeight/2;let c=l.clientHeight-r.clientHeight,u=l.clientWidth-r.clientWidth;c>0&&(c=0),u>0&&(u=0),o.value=e>d?d:e<u?u:e,a.value=n<c?c:n>s?s:n}function c(e,t){s(e,t),n("on-drag-stop",{x:e,y:t})}const u=l(!1),i=k({value:{}});const p=l(!1),m=l(0),v=l(0),y=k({data:{}});const h=l(1);function b(n){if(!e.scalable)return;const t=Number((Number(h.value)+n).toFixed(1));h.value=n>0?Math.min(3,t):Math.max(.3,t)}function x(e,n,t){d.value=!0;const l=e.offsetLeft-n,r=e.offsetTop-t;o.value-=l,a.value-=r,s(o.value,a.value)}let N;const D=k(Object.assign({id:"id",pid:"pid",label:"label",expand:"expand",children:"children"},e.props));const C=l(!1);function E(e){e.forEach((e=>{e.expand&&(e.expand=!1),e.children&&E(e.children)}))}const z=l(!1);function O(e,n){Array.isArray(e)?e.forEach((e=>{e.expand=n,e.children&&O(e.children,n)})):(e.expand=n,e.children&&O(e.children,n))}const M=r((()=>({width:100/h.value+"%",height:100/h.value+"%",transform:`scale(${h.value})`}))),R=r((()=>`${Math.round(100*h.value)}%`)),_=r((()=>e.draggableOnNode||!e.nodeDraggable?"":".tree-org-node-label")),w=r((()=>z.value?"收起全部节点":"展开全部节点")),$=r((()=>z.value?"收起全部节点":"展开全部节点")),B=k({data:{}}),A=r((()=>{const{cloneNodeDrag:n,onlyOneNode:t,data:o}=e;return{drag:e.nodeDraggable,dragData:{keys:D,nodeMoving:u,parenNode:i,cloneNodeDrag:n,onlyOneNode:t,contextmenu:p,cloneData:B,data:o},handleStart:e.nodeDragStart,handleMove:e.nodeDraging,handleEnd:e.nodeDragEnd}}));g((()=>e.horizontal),(()=>{S((()=>{c(o.value,a.value)}))}));const F=l(e.data);g((()=>e.data),(()=>{F.value=e.data}));const T=k({visible:!0,data:{expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0}});return f((()=>{"object"==typeof e.toolBar?Object.assign(T.data,e.toolBar):e.toolBar||(T.visible=!1)})),{keys:D,left:o,top:a,menuX:m,menuY:v,nodeMoving:u,zoomStyle:M,tools:T,zoomPercent:R,dragCancel:_,expandTitle:w,fullTiltle:$,nodeargs:A,expanded:z,fullscreen:C,treeData:F,autoDragging:d,contextmenu:p,menuData:y,cloneData:B,zoomWheel:function(t){e.scalable&&(t.preventDefault(),t.deltaY<0?b(.1):b(-.1),n("on-zoom",h.value))},onDrag:function(e,t){d.value=!1,o.value=e,a.value=t,n("on-drag",{x:e,y:t})},onDragStop:c,expandChange:function(){z.value=!z.value,O(e.data,z.value),z.value||S((()=>{c(o.value,a.value)}))},handleFullscreen:function(){C.value=!C.value,C.value?function(){const e=t.eleRef.value;e.requestFullscreen&&e.requestFullscreen()}():document.exitFullscreen&&document.exitFullscreen()},zoomOrgchart:b,restoreOrgchart:function(){h.value=1,o.value=0,a.value=0},handleExpand:function(e,t){e.stopPropagation();const o=document.querySelector(".is-root");if(o){const a=o.offsetLeft,l=o.offsetTop;"expand"in t?(t.expand=!t.expand,!t.expand&&t.children&&E(t.children)):t.expand=!0,S((()=>{x(o,a,l)})),n("on-expand",e,t)}},nodeMouseenter:function(e,t){return u.value&&(i.value=t),n("on-node-mouseenter",e,t),!0},nodeMouseleave:function(e,t){return u.value&&(i.value=null),n("on-node-mouseleave",e,t),!0},nodeContextmenu:function(e,n){e.stopPropagation(),e.preventDefault(),p.value=!0,m.value=e.clientX,v.value=e.clientY,y.data=n},handleBlur:function(e,t){const{children:o,id:a,label:l}=D,r=y.data[o]||[];for(let e=r.length;e>0;e--){const n=r[e-1];if(""===n[a]&&""===n[l]){r.splice(e-1,1);break}}n("on-node-blur",e,t)},handleClick:function(t,o){clearTimeout(N),N=setTimeout((()=>{n("on-node-click",t,o)}),e.clickDelay)},handleDblclick:function(e,t){clearTimeout(N),n("on-node-dblclick",e,t)}}};var Ee=a({name:"vue3TreeOrg",components:{Tools:J,CloneOrg:ge,Draggable:ve,Contextmenu:be,TreeOrgNode:I},directives:{nodedrag:Y},props:De,emits:{"on-drag":({x:e,y:n})=>A(e)&&A(n),"on-drag-stop":({x:e,y:n})=>A(e)&&A(n),"on-zoom":e=>A(e),"on-expand":(e,n)=>e instanceof MouseEvent&&$(n),"on-node-blur":(e,n)=>e instanceof MouseEvent&&$(n),"on-node-click":(e,n)=>e instanceof MouseEvent&&$(n),"on-node-dblclick":(e,n)=>e instanceof MouseEvent&&$(n),"on-node-mouseenter":(e,n)=>e instanceof MouseEvent&&$(n),"on-node-mouseleave":(e,n)=>e instanceof MouseEvent&&$(n),"on-contextmenu":e=>$(e),"on-node-copy":e=>B(e),"on-node-delete":e=>$(e),"on-node-focus":(e,n)=>e instanceof MouseEvent&&$(n)},setup(e,n){const t=l(),o=l(),a=l();return{eleRef:t,treeRef:o,zoomRef:a,...Ce(e,n,{eleRef:t,treeRef:o,zoomRef:a})}}});const Se={ref:"eleRef",class:"zm-tree-org"},ke={class:"tree-org-node__text"},ze=i("span",{class:"tree-org-node__expand-btn"},null,-1),Oe={class:"tree-org-node__text"},Me=i("span",{class:"tree-org-node__expand-btn"},null,-1);Ee.render=function(e,n,t,o,a,l){const r=x("tree-org-node"),f=x("Draggable"),m=x("Tools"),v=x("clone-org"),g=x("Contextmenu");return d(),s("div",Se,[i("div",{ref:"zoomRef",class:"zoom-container",style:h(e.zoomStyle),onWheel:n[1]||(n[1]=(...n)=>e.zoomWheel&&e.zoomWheel(...n))},[C(f,{x:e.left,y:e.top,class:p({dragging:e.autoDragging}),onDragging:e.onDrag,onDragstop:e.onDragStop,draggable:e.draggable,"drag-cancel":e.dragCancel},{default:E((()=>[i("div",{ref:"treeRef",class:p(["tree-org",{horizontal:e.horizontal,collapsable:e.collapsable}])},[C(r,{data:e.treeData,props:e.keys,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,selectedKey:e.selectedKey,defaultExpandLevel:e.defaultExpandLevel,selectedClassName:e.selectedClassName,labelClassName:e.labelClassName,vNodedrag:e.nodeargs,onOnExpand:e.handleExpand,onNodeClick:e.handleClick,onNodeDblclick:e.handleDblclick,onNodeMouseenter:e.nodeMouseenter,onNodeMouseleave:e.nodeMouseleave,onNodeContextmenu:e.nodeContextmenu,onNodeFocus:n[0]||(n[0]=(n,t)=>{e.$emit("on-node-focus",n,t)}),onNodeBlur:e.handleBlur},{default:E((({node:n})=>[b(e.$slots,"default",{node:n},(()=>[i("div",ke,[i("span",null,c(n.label),1)])]))])),expand:E((({node:n})=>[b(e.$slots,"expand",{node:n},(()=>[ze]))])),_:3},8,["data","props","horizontal","labelStyle","collapsable","renderContent","selectedKey","defaultExpandLevel","selectedClassName","labelClassName","vNodedrag","onOnExpand","onNodeClick","onNodeDblclick","onNodeMouseenter","onNodeMouseleave","onNodeContextmenu","onNodeBlur"])],2)])),_:3},8,["x","y","class","onDragging","onDragstop","draggable","drag-cancel"])],36),e.tools.visible?(d(),N(m,{key:0,tools:e.tools.data,scale:e.zoomPercent,onOnExpand:e.expandChange,onOnScale:e.zoomOrgchart,onOnRestore:e.restoreOrgchart,onOnFullscreen:e.handleFullscreen},null,8,["tools","scale","onOnExpand","onOnScale","onOnRestore","onOnFullscreen"])):u("v-if",!0),e.nodeDraggable?(d(),N(v,{key:1,modelValue:e.nodeMoving,"onUpdate:modelValue":n[2]||(n[2]=n=>e.nodeMoving=n),props:e.keys,data:e.cloneData.data,horizontal:e.horizontal,"label-style":e.labelStyle,collapsable:e.collapsable,"render-content":e.renderContent,"label-class-name":e.labelClassName},{default:E((({node:n})=>[b(e.$slots,"default",{node:n},(()=>[i("div",Oe,[i("span",null,c(n[e.keys.label]),1)])]))])),expand:E((({node:n})=>[b(e.$slots,"expand",{node:n},(()=>[Me]))])),_:3},8,["modelValue","props","data","horizontal","label-style","collapsable","render-content","label-class-name"])):u("v-if",!0),e.defineMenus.length?(d(),N(g,{key:2,modelValue:e.contextmenu,"onUpdate:modelValue":n[3]||(n[3]=n=>e.contextmenu=n),x:e.menuX,y:e.menuY,node:e.menuData.data,data:e.data,props:e.keys,menus:e.defineMenus,disabled:e.disabled,"node-add":e.nodeAdd,"node-delete":e.nodeDelete,"node-edit":e.nodeEdit,"node-copy":e.nodeCopy,onContextmenu:n[4]||(n[4]=n=>{e.$emit("on-contextmenu",n)}),onOnNodeCopy:n[5]||(n[5]=n=>{e.$emit("on-node-copy",n)}),onOnNodeDelete:n[6]||(n[6]=n=>{e.$emit("on-node-delete",n)})},null,8,["modelValue","x","y","node","data","props","menus","disabled","node-add","node-delete","node-edit","node-copy"])):u("v-if",!0)],512)},Ee.__file="src/components/tree-org/src/tree.vue",Ee.install=function(e){e.component(Ee.name,Ee)};const Re=[Ee];var _e={install:function(e){Re.forEach((n=>{e.component(n.name,n)})),e.use(L)},Vue3TreeOrg:Ee};export{Ee as Vue3TreeOrg,_e as default};
